# NPL Cricket Tournament - Render Deployment Guide

This guide will walk you through deploying the NPL Cricket Tournament Management System to Render.com using GitHub.

## Prerequisites

- GitHub account
- Render.com account (free tier works)
- Git installed on your computer

## Step 1: Prepare Your Repository

### 1.1 Initialize Git (if not already done)

```bash
git init
```

### 1.2 Check Git Status

```bash
git status
```

You should see untracked files and modified files listed.

### 1.3 Stage All Files

```bash
git add .
```

### 1.4 Commit Your Changes

```bash
git commit -m "Prepare for Render deployment with seeded data"
```

## Step 2: Create GitHub Repository

### 2.1 Create Repository on GitHub

1. Go to https://github.com
2. Click the "+" icon in the top right
3. Select "New repository"
4. Fill in the details:
   - **Repository name**: `npl-cricket-tournament` (or your preferred name)
   - **Description**: NPL Cricket Tournament Management System
   - **Visibility**: Public or Private (your choice)
   - **DO NOT** initialize with README, .gitignore, or license (we already have these)
5. Click "Create repository"

### 2.2 Link Your Local Repository to GitHub

GitHub will show you commands. Use these (replace YOUR_USERNAME with your GitHub username):

```bash
git remote add origin https://github.com/YOUR_USERNAME/npl-cricket-tournament.git
git branch -M main
git push -u origin main
```

### 2.3 Verify Upload

Refresh your GitHub repository page. You should see all your files uploaded.

## Step 3: Deploy to Render

### 3.1 Sign Up / Log In to Render

1. Go to https://render.com
2. Sign up or log in
3. Connect your GitHub account if you haven't already

### 3.2 Create New Web Service

1. From the Render dashboard, click **"New +"** button
2. Select **"Web Service"**
3. Click **"Connect account"** next to GitHub (if not already connected)
4. Authorize Render to access your GitHub repositories

### 3.3 Select Your Repository

1. Find your `npl-cricket-tournament` repository in the list
2. Click **"Connect"**

### 3.4 Configure the Web Service

Render will auto-detect most settings from your `render.yaml` file. Verify/fill in:

- **Name**: `npl-cricket-tournament` (or your preferred name)
- **Region**: Select the closest region to you
- **Branch**: `main`
- **Root Directory**: Leave blank
- **Environment**: `Python 3`
- **Build Command**: `bash build.sh` (should be auto-filled from render.yaml)
- **Start Command**: `gunicorn --bind 0.0.0.0:$PORT "backend.app:create_app()"` (should be auto-filled)

### 3.5 Set Environment Variables (Optional)

These are already set in render.yaml, but you can verify:

- `FLASK_ENV`: `production`
- `PORT`: Auto-generated by Render

### 3.6 Select Plan

- Choose **"Free"** plan (sufficient for testing and small deployments)

### 3.7 Deploy

1. Click **"Create Web Service"**
2. Render will start building and deploying your application
3. This process takes 3-5 minutes

## Step 4: Monitor Deployment

### 4.1 Watch Build Logs

- Render will show live build logs
- You should see:
  - Installing dependencies
  - Creating directories
  - Initializing database
  - Seeding data (teams, players, matches)
  - Build completed successfully

### 4.2 Check for Errors

If the build fails:
- Check the logs for error messages
- Common issues:
  - Missing dependencies in requirements.txt
  - Build script permissions
  - Python version mismatch

## Step 5: Verify Deployment

### 5.1 Access Your Application

Once deployed, Render will provide a URL like:
```
https://npl-cricket-tournament.onrender.com
```

### 5.2 Test the Application

1. Visit the URL in your browser
2. You should see the home page
3. Test the admin login:
   - Username: `admin`
   - Password: `admin123`

### 5.3 Verify Data

Test the API endpoints:
- Teams: `https://your-app.onrender.com/api/teams`
- Matches: `https://your-app.onrender.com/api/matches`
- Tournament: `https://your-app.onrender.com/api/tournament`

## Step 6: Update and Redeploy

### 6.1 Make Changes Locally

Edit your files as needed.

### 6.2 Commit and Push

```bash
git add .
git commit -m "Description of changes"
git push origin main
```

### 6.3 Automatic Deployment

Render will automatically detect the push and redeploy your application!

## Important Notes

### Database Persistence

- Render's free tier uses ephemeral storage
- The database will reset if the service restarts after inactivity
- For production, consider upgrading to a paid plan or using a managed database

### Free Tier Limitations

- Service spins down after 15 minutes of inactivity
- First request after spin-down takes 30-60 seconds (cold start)
- 750 hours/month free (shared across services)

### Security

- Change the default admin password after first login
- For production, use environment variables for sensitive data
- Consider adding rate limiting for APIs

## Troubleshooting

### Build Fails

**Error**: `bash: build.sh: Permission denied`

**Solution**: Make build.sh executable before pushing:
```bash
git update-index --chmod=+x build.sh
git commit -m "Make build script executable"
git push origin main
```

### Database Not Seeding

**Error**: Database tables are empty

**Solution**: Check build logs to ensure seed_data.py ran successfully

### Application Not Starting

**Error**: `Application failed to start`

**Solution**:
- Check that gunicorn is in requirements.txt
- Verify start command in render.yaml
- Check logs for Python errors

### 502 Bad Gateway

**Issue**: Application takes too long to start

**Solution**:
- Wait 1-2 minutes for cold start
- Check logs for startup errors
- Verify PORT environment variable is being used

## Custom Domain (Optional)

To use your own domain:

1. Go to your service settings in Render
2. Click "Custom Domain"
3. Add your domain
4. Update your DNS settings as instructed by Render

## Support

- Render Docs: https://render.com/docs
- Render Community: https://community.render.com
- GitHub Issues: Create an issue in your repository

## Quick Reference Commands

```bash
# Check git status
git status

# Add all changes
git add .

# Commit changes
git commit -m "Your message"

# Push to GitHub
git push origin main

# View git log
git log --oneline

# Check remote URL
git remote -v
```

---

**Deployment Checklist:**

- [ ] Git repository initialized
- [ ] All files committed
- [ ] GitHub repository created
- [ ] Code pushed to GitHub
- [ ] Render account created
- [ ] GitHub connected to Render
- [ ] Web service created on Render
- [ ] Deployment successful
- [ ] Application accessible via URL
- [ ] Admin login works
- [ ] Teams and matches data visible
- [ ] Custom domain configured (optional)

---

**Congratulations!** Your NPL Cricket Tournament Management System is now live on the internet!
